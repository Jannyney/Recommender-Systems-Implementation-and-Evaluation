# Recommender Systems Implementation and Evaluation  
*Author: Tawanrat Piriyalertsak*  
*Date: 2025-05-14*

## Introduction

In this report, we describe the implementation of several recommender systems approaches: content-based, collaborative filtering, hybrid, and a model-based framework. We also summarize the results from the evaluation and provide insights on potential improvements and future work.

## Implementation

The recommender systems approaches were implemented using the MovieLens dataset, focusing on evaluating each method's effectiveness using common metrics such as Precision, Recall, F1-score, MRR, nDCG, and Diversity.

### Content-Based Recommender System

The content-based recommender system utilizes information about the movies' genres to build user profiles. Each user's profile is created based on the genres of the movies they have rated highly (rating >= 2.5). The recommendation for each user is generated by calculating the cosine similarity between their profile and the genre vectors of the movies that the user has not rated yet.

**Key Steps:**

- Build a genre matrix from the movies dataset.  
- Build user profiles by aggregating the genres of movies that the user has rated.  
- Recommend movies by calculating the cosine similarity between user profiles and movie genre vectors.

### Collaborative Filtering Recommender System

The collaborative filtering approach uses user-item interactions (ratings) to recommend items. It calculates similarities between users based on their ratings and recommends items that similar users have liked. The recommendation process leverages the `cosine similarity` between users.

**Key Steps:**

- Build a user-item matrix from the training data.  
- Compute pairwise similarities between users.  
- Recommend items that similar users have rated highly.

### Hybrid Recommender Systems

The hybrid recommender systems combine the strengths of both content-based and collaborative filtering approaches.

1. **Hybrid (CF then CB):** This method first applies collaborative filtering to filter out the top N recommended items. Then, content-based filtering ranks the top N items based on similarity to the user's profile.  
2. **Hybrid (CB then CF):** In this method, content-based filtering first filters the top N items. Then, collaborative filtering ranks these top N items based on the user's similarity to other users.

**Key Steps for Both Approaches:**

- **CF first, CB ranking:** Apply collaborative filtering to generate a list of top N items, then use content-based ranking to order these items.  
- **CB first, CF ranking:** Apply content-based filtering to generate top N items, then rank them using collaborative filtering.

### Framework-Based Recommender System

The model-based framework approach implements a generic recommender system framework that combines content-based and collaborative filtering. This method uses matrix factorization techniques to generate recommendations, considering both item content and user-item interaction patterns.

**Key Steps:**

- Factorize the user-item interaction matrix.  
- Incorporate item content features into the matrix factorization process.  
- Use the learned model to predict ratings and generate recommendations.

## Evaluation

We evaluated each recommender system approach on the MovieLens dataset using several performance metrics.

### Results Summary

| Model                    | k | Precision | Recall | F1    | MRR    | nDCG   | Diversity |
|--------------------------|---|-----------|--------|-------|--------|--------|-----------|
| content-based            | 1 | 0.0377    | 0.0008 | 0.0015| 0.0377 | 0.0377 | 1.0       |
| content-based            | 3 | 0.0344    | 0.0021 | 0.0037| 0.0590 | 0.0348 | 1.0       |
| content-based            | 5 | 0.0354    | 0.0033 | 0.0056| 0.0689 | 0.0355 | 1.0       |
| collaborative-filtering  | 1 | 0.4180    | 0.0109 | 0.0209| 0.4180 | 0.4180 | 1.0       |
| collaborative-filtering  | 3 | 0.3923    | 0.0302 | 0.0530| 0.5331 | 0.3979 | 1.0       |
| collaborative-filtering  | 5 | 0.3754    | 0.0471 | 0.0768| 0.5560 | 0.3847 | 1.0       |
| hybrid-cf-then-cb        | 1 | 0.3410    | 0.0079 | 0.0150| 0.3410 | 0.3410 | 1.0       |
| hybrid-cf-then-cb        | 3 | 0.3197    | 0.0216 | 0.0383| 0.4536 | 0.3239 | 1.0       |
| hybrid-cf-then-cb        | 5 | 0.3213    | 0.0367 | 0.0604| 0.4840 | 0.3240 | 1.0       |
| hybrid-cb-then-cf        | 1 | 0.2689    | 0.0056 | 0.0107| 0.2689 | 0.2689 | 1.0       |
| hybrid-cb-then-cf        | 3 | 0.1776    | 0.0104 | 0.0186| 0.3194 | 0.1984 | 1.0       |
| hybrid-cb-then-cf        | 5 | 0.1387    | 0.0124 | 0.0209| 0.3295 | 0.1657 | 1.0       |

### Best Performing Approach

The **collaborative filtering** approach performs best overall, achieving the highest Precision and MRR values across all k values. It also maintains a high level of Diversity, indicating its ability to recommend a wide variety of items to users.

The **hybrid (CF then CB)** approach shows a significant improvement over content-based filtering alone, but still lags behind collaborative filtering in terms of Precision and MRR.

### Link to Full Results

The complete evaluation results for each recommender system are provided in the following CSV files located in the `results/` directory:

- `content_based_results.csv` – Full metrics for content-based filtering  
- `collaborative_filtering_results.csv` – Full metrics for collaborative filtering  
- `hybrid_results.csv` – Combined hybrid results  
- `*_top10.csv` – Top-10 recommended movies per user for each model variant:  
  - `content_based_top10.csv`  
  - `collaborative_filtering_top10.csv`  
  - `hybrid_cb_then_cf_top10.csv`  
  - `hybrid_cf_then_cb_top10.csv`  

You can access these files directly in the repository to review detailed metrics and top-N recommendations.

## Issues and Challenges

During the design and implementation of the recommender systems, several challenges were encountered:

1. **Data Sparsity:** The collaborative filtering method suffered from data sparsity, as many users had rated only a small fraction of the available movies. This made it challenging to find similar users for recommendations, especially for less active users.  
2. **Cold Start Problem:** Content-based filtering and hybrid approaches also faced the cold start problem, where new users or items with little historical data could not be effectively recommended.

## Ideas for Extensions and Future Work

There are several potential extensions and improvements for this project:

1. **Incorporate Implicit Feedback:** The current approach only considers explicit ratings. Incorporating implicit feedback (e.g., clicks, views, etc.) could improve recommendation quality.  
2. **Use Advanced Matrix Factorization Models:** Techniques like Singular Value Decomposition (SVD) or Alternating Least Squares (ALS) could be used to improve collaborative filtering performance.  
3. **Context-Aware Recommendations:** Consider incorporating contextual information (e.g., time of day, location, or device used) to make recommendations more personalized.  
4. **Evaluation with More Metrics:** Future evaluations could consider additional metrics such as user satisfaction or long-term engagement to better assess the system's effectiveness.

## Conclusion

This project successfully implemented and evaluated multiple recommender systems approaches, including content-based, collaborative filtering, hybrid models, and a model-based framework. Collaborative filtering emerged as the best-performing approach, but hybrid methods showed promise in leveraging the strengths of both content-based and collaborative techniques.
